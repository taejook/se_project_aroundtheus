!function(){"use strict";class e{constructor(e,t,r,s,i){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteCard=s,this.id=e._id,this.isLiked=e.isLiked,this._handleLikeCard=i}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)})),this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this))),this._cardImageEl.addEventListener("click",(()=>this._handleImageClick(this)))}handleDelete(){this._cardElement.remove(),this._cardElement=null}_renderLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".cards__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name+" Image",this._cardTitleEl.textContent=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._renderLikes(),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this.errorMessageElement.textContent=e.validationMessage,this.errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this.errorMessageElement.textContent=" ",this.errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._form.reset(),this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close")&&this.close()}))}}class s extends r{constructor(e,t){let{popupSelector:r}=e;super({popupSelector:r}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputElements=this._popupForm.querySelectorAll(".modal__input"),this._buttonElement=this._popupForm.querySelector(".modal__button")}open(){super.open()}close(){super.close(),this._popupForm.reset()}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}class i{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItems(e){this._container.prepend(e)}}document.querySelectorAll(".modal__form");const n=document.querySelector("#profile-edit-button"),o=document.querySelector("#profile-edit-modal"),a=document.querySelector("#avatar-edit-modal"),l=document.querySelector("#add-card-modal"),d=document.querySelector("#preview-image-modal"),c=a.querySelector(".modal__form"),u=document.querySelector(".profile__image-button"),h=(o.querySelector("#profile-modal-close"),l.querySelector("#add-card-modal-close"),d.querySelector("#preview-modal-close"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-name"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-edit-form")),_=l.querySelector("#add-card-form"),m=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".profile__add-button"),document.querySelector("#profile-title-input")),p=document.querySelector("#profile-description-input"),E=(_.querySelector(".modal__input_type_title"),_.querySelector(".modal__input_type_url"),document.querySelectorAll(".modal__close"),document.querySelector(".profile__add-button")),S={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},v=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}fetchUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}deleteInitialCards(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"PUT"}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"41597df2-eb93-4b41-8bf1-f4a542a9ea54","Content-Type":"application/json"}}),f=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._image=this._popupElement.querySelector(".modal__preview-image"),this._caption=this._popupElement.querySelector(".modal__preview-description")}open(e){super.open(),this._image.setAttribute("src",e._link),this._image.setAttribute("alt",e._name),this._caption.textContent=e._name}}({popupSelector:"#preview-image-modal"}),y=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._deletePopup=this._popupElement.querySelector("#modal__confirm"),this._buttonElement=this._deletePopup.querySelector(".modal__button")}setEventListeners(){this._popupElement.querySelector(".modal__button").addEventListener("click",(()=>{this._handleDelete()})),super.setEventListeners()}setSubmitAction(e){this._handleDelete=e}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}({popupSelector:"#delete-card-modal"}),b=new class{constructor(e,t,r){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,description:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.about}setAvatar(e){let{avatar:t}=e;this._avatar.src=t}}(".profile__title",".profile__description",".profile__image");let L;v.getInitialCards().then((t=>{L=new i({items:t,renderer:t=>{const r=new e(t,"#card-template",B,C,I);L.addItems(r.getView())}},".cards__list"),L.renderItems()})).catch((e=>{console.error(e)})),v.fetchUserInfo().then((e=>{b.setUserInfo({name:e.name,about:e.about}),b.setAvatar({avatar:e.avatar})})).catch((e=>{console.error(e)}));const k=new s({popupSelector:"#add-card-modal"},(function(t){k.renderLoading(!0),v.addCard({name:t.name,link:t.link}).then((t=>{const r=function(t){return new e(t,"#card-template",B,C,I).getView()}(t);L.addItems(r),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.renderLoading(!1)}))})),g=new s({popupSelector:"#profile-edit-modal"},(function(e){g.renderLoading(!0),v.editUserInfo(e).then((e=>{b.setUserInfo(e),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.renderLoading(!1)}))})),q=new s({popupSelector:"#avatar-edit-modal"},(function(e){q.renderLoading(!0),v.editAvatar({avatar:e.link}).then((e=>{b.setAvatar(e),q.close()})).catch((e=>{console.error(e)})).finally((()=>{q.renderLoading(!1)}))}));function C(e){y.open(),y.setSubmitAction((()=>{y.renderLoading(!0),v.deleteInitialCards(e.id).then((()=>{e.handleDelete(),y.close()})).catch((e=>{console.error(e)})).finally((()=>{y.renderLoading(!1)}))}))}function I(e){e.isLiked&&v.unlikeCard(e.id).then((()=>{e.setIsLiked(!1)})).catch((e=>{console.error(e)})),e.isLiked||v.likeCard(e.id).then((()=>{e.setIsLiked(!0)})).catch((e=>{console.error(e)}))}function B(e){f.open(e)}E.addEventListener("click",(()=>{k.open(),U.toggleButtonState()})),n.addEventListener("click",(()=>{const e=b.getUserInfo();m.value=e.name,p.value=e.about,g.open(),w.toggleButtonState()})),u.addEventListener("click",(()=>{q.open(),A.toggleButtonState()}));const w=new t(S,h),U=new t(S,_),A=new t(S,c);w.enableValidation(),U.enableValidation(),A.enableValidation(),k.setEventListeners(),g.setEventListeners(),f.setEventListeners(),y.setEventListeners(),q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SixPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLEdBRzFCLENBeUNBLFNBQVN2TCxFQUFpQmtNLEdBQ3hCN0UsRUFBa0J0QyxLQUFLbUgsRUFDekIsQ0FJQXJFLEVBQWM1RyxpQkFBaUIsU0FBUyxLQUN0Q3lLLEVBQWEzRyxPQUNib0gsRUFBaUJ4SSxtQkFBbUIsSUFHdENzRCxFQUFlaEcsaUJBQWlCLFNBQVMsS0FDdkMsTUFBTW1MLEVBQWU3QixFQUFTTyxjQUM5QnBELEVBQWtCeEIsTUFBUWtHLEVBQWEvTCxLQUN2Q3VILEVBQXdCMUIsTUFBUWtHLEVBQWFuRCxNQUM3QzZDLEVBQWlCL0csT0FDakJzSCxFQUFrQjFJLG1CQUFtQixJQUd2QzRELEVBQWF0RyxpQkFBaUIsU0FBUyxLQUNyQytLLEVBQWdCakgsT0FDaEJ1SCxFQUFvQjNJLG1CQUFtQixJQUl6QyxNQUFNMEksRUFBb0IsSUFBSWhLLEVBQWNDLEVBQVVrRixHQUNoRDJFLEVBQW1CLElBQUk5SixFQUFjQyxFQUFVbUYsR0FDL0M2RSxFQUFzQixJQUFJakssRUFBY0MsRUFBVWdGLEdBU3hEK0UsRUFBa0JoSSxtQkFDbEI4SCxFQUFpQjlILG1CQUNqQmlJLEVBQW9CakksbUJBRXBCcUgsRUFBYXJHLG9CQUNieUcsRUFBaUJ6RyxvQkFDakJnQyxFQUFrQmhDLG9CQUNsQjhFLEVBQVk5RSxvQkFDWjJHLEVBQWdCM0csbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlQ2FyZCwgaGFuZGxlTGlrZUNhcmQpIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzKVxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcylcbiAgICApO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpe1xuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIHNldElzTGlrZWQoaXNMaWtlZCkge1xuICAgIC8vIHNldCBpbnN0YW5jZSB2YXJpYWJsZVxuICAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAvL2dldCB0aGUgY2FyZCB2aWV3XG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWUgKyBcIiBcIiArIFwiSW1hZ2VcIjtcbiAgICB0aGlzLl9jYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICB0aGlzLl9yZW5kZXJMaWtlcygpXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIC8vcmV0dXJuIHRoZSBjYXJkXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcblxuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiIFwiO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiAhaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpe1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpXG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgfVxuXG4gICAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICAgIH1cblxuICAgICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgfVxuXG4gICAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9LCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIH1cblxuICAgIG9wZW4oKSB7XG4gICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICBzdXBlci5jbG9zZSgpO1xuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICAgIH1cbiAgICBcbiAgICAgIHJlbmRlckl0ZW1zKCkge1xuICAgICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIFxuICAgICAgYWRkSXRlbXMoZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9IiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWJ1dHRvblwiKVxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbENsb3NlID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLW1vZGFsLWNsb3NlXCJcbik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2UgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjYWRkLWNhcmQtbW9kYWwtY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxDbG9zZSA9IHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3ByZXZpZXctbW9kYWwtY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld05hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcbik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcblxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCJcbik7XG5leHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91cmxcIik7XG5cbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZVwiKTtcblxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59OyIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCAnLi4vcGFnZXMvaW5kZXguY3NzJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanNcIlxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIGNhcmRMaXN0RWwsXG4gIHByb2ZpbGVFZGl0QnRuLFxuICBwcm9maWxlRWRpdEZvcm0sXG4gIGFkZENhcmRGb3JtLFxuICBhZGRDYXJkTW9kYWwsXG4gIGF2YXRhckJ1dHRvbixcbiAgYWRkQ2FyZEJ1dHRvbixcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxuICBhdmF0YXJGb3JtLFxuICBzZXR0aW5ncyxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuLy9jb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsICcjY2FyZC10ZW1wbGF0ZScpO1xuLy9jYXJkLl9nZXRWaWV3KCk7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjQxNTk3ZGYyLWViOTMtNGI0MS04YmYxLWY0YTU0MmE5ZWE1NFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gIH1cbn0pO1xuXG4vL0NsYXNzIEluc3RhbmNlc1xuY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoeyBwb3B1cFNlbGVjdG9yOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIgfSk7XG5jb25zdCBwb3B1cERlbGV0ZSA9IG5ldyBQb3B1cFdpdGhEZWxldGUoeyBwb3B1cFNlbGVjdG9yOiBcIiNkZWxldGUtY2FyZC1tb2RhbFwiIH0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLCBcIi5wcm9maWxlX19pbWFnZVwiKTtcblxubGV0IHNlY3Rpb247XG5cbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChpbml0aWFsQ2FyZHMpID0+IHtcbiAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgIHtcbiAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcbiAgICAgICAgICBkYXRhLFxuICAgICAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICAgICAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgICAgICAgIGhhbmRsZURlbGV0ZSxcbiAgICAgICAgICBoYW5kbGVMaWtlQ2FyZFxuICAgICAgICApO1xuICAgICAgICBzZWN0aW9uLmFkZEl0ZW1zKGNhcmRFbGVtZW50LmdldFZpZXcoKSk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgXCIuY2FyZHNfX2xpc3RcIlxuICApO1xuICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG59KVxuLmNhdGNoKChlcnIpID0+IHtcbiAgY29uc29sZS5lcnJvcihlcnIpO1xufSk7XG5hcGkuZmV0Y2hVc2VySW5mbygpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcbiAgfSk7XG4gIHVzZXJJbmZvLnNldEF2YXRhcih7IGF2YXRhcjogdXNlckRhdGEuYXZhdGFyIH0pO1xufSlcbi5jYXRjaCgoZXJyKSA9PiB7XG4gIGNvbnNvbGUuZXJyb3IoZXJyKTtcbn0pO1xuXG4gICAgY29uc3QgYWRkQ2FyZFBvcFVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgICB7IHBvcHVwU2VsZWN0b3I6IFwiI2FkZC1jYXJkLW1vZGFsXCIgfSxcbiAgICAgIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0XG4gICAgKTtcblxuICAgIGNvbnN0IGVkaXRQcm9maWxlUG9wVXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgICAgIHsgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIgfSxcbiAgICAgIGhhbmRsZVByb2ZpbGVFZGl0Rm9ybVN1Ym1pdFxuICAgICk7XG5cbiAgICBjb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgICAgIHsgcG9wdXBTZWxlY3RvcjogXCIjYXZhdGFyLWVkaXQtbW9kYWxcIiB9LFxuICAgICAgaGFuZGxlQXZhdGFyU3VibWl0XG4gICAgKTtcblxuLypGdW5jdGlvbnMqL1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZSxcbiAgICBoYW5kbGVMaWtlQ2FyZFxuICApLmdldFZpZXcoKTtcbiAgcmV0dXJuIGNhcmQ7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRBdmF0YXIoeyBhdmF0YXI6IGlucHV0VmFsdWVzLmxpbmsgfSlcbiAgICAudGhlbigobmV3QXZhdGFyKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIobmV3QXZhdGFyKTtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlKGNhcmQpIHtcbiAgcG9wdXBEZWxldGUub3BlbigpO1xuICBwb3B1cERlbGV0ZS5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIHBvcHVwRGVsZXRlLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlSW5pdGlhbENhcmRzKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlKCk7XG4gICAgICAgIHBvcHVwRGVsZXRlLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcG9wdXBEZWxldGUucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDYXJkKGNhcmQpIHtcbiAgaWYgKGNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLnVubGlrZUNhcmQoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5zZXRJc0xpa2VkKGZhbHNlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuICBpZiAoIWNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuc2V0SXNMaWtlZCh0cnVlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBhZGRDYXJkUG9wVXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmFkZENhcmQoe1xuICAgICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcbiAgICAgIGxpbms6IGlucHV0VmFsdWVzLmxpbmssXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gICAgICBzZWN0aW9uLmFkZEl0ZW1zKGNhcmQpO1xuICAgICAgYWRkQ2FyZFBvcFVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZFBvcFVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5cblxuLy9FdmVudCBIYW5kbGVyc1xuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGVkaXRQcm9maWxlUG9wVXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcylcbiAgICAudGhlbigobmV3VXNlckRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5ld1VzZXJEYXRhKTtcbiAgICAgIGVkaXRQcm9maWxlUG9wVXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UHJvZmlsZVBvcFVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XG4gIHByZXZpZXdJbWFnZU1vZGFsLm9wZW4oY2FyZERhdGEpO1xufVxuXG4vKkV2ZW50IExpc3RlbmVycyovXG4vL2FkZCBuZXcgQ2FyZCBidXR0b25cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkQ2FyZFBvcFVwLm9wZW4oKTtcbiAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG5cbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJJbmZvRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlckluZm9EYXRhLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckluZm9EYXRhLmFib3V0O1xuICBlZGl0UHJvZmlsZVBvcFVwLm9wZW4oKTtcbiAgZWRpdEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbn0pO1xuXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG5cblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcHJvZmlsZUVkaXRGb3JtKTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkQ2FyZEZvcm0pO1xuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhdmF0YXJGb3JtKTtcblxuLy9mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIC8vY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAvL3NlY3Rpb24uYWRkSXRlbXMoY2FyZCk7XG4vL31cblxuLy9WYWxpZGF0aW9uXG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmFkZENhcmRQb3BVcC5zZXRFdmVudExpc3RlbmVycygpO1xuZWRpdFByb2ZpbGVQb3BVcC5zZXRFdmVudExpc3RlbmVycygpO1xucHJldmlld0ltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRGVsZXRlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGl7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuX2NoZWNrUmVzcG9uc2UocmVzKXtcbiAgaWYgKHJlcy5vaykge1xuICAgIHJldHVybiByZXMuanNvbigpO1xuICB9XG4gIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbn1cblxuICBmZXRjaFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBkZWxldGVJbml0aWFsQ2FyZHMoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1bmxpa2VDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG4gICAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctZGVzY3JpcHRpb25cIik7XG4gICAgfVxuXG4gICAgb3BlbihkYXRhKSB7XG4gICAgICBzdXBlci5vcGVuKCk7XG4gICAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgZGF0YS5fbGluayk7XG4gICAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgZGF0YS5fbmFtZSk7XG4gICAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5fbmFtZTtcbiAgICB9XG4gIH0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXB3aXRoRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9kZWxldGVQb3B1cCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX19jb25maXJtXCIpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9kZWxldGVQb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGUoKTtcbiAgICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oaGFuZGxlRGVsZXRlKSB7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlID0gaGFuZGxlRGVsZXRlO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH1cbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCB1c2VyQXZhdGFyKSB7XG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhcik7XG4gICAgICB9XG5cbiAgICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBzZXRVc2VySW5mbyh1c2VyRGF0YSkge1xuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgICAgIH1cblxuICAgICAgc2V0QXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgICAgIH1cbiAgICB9Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkIiwiaWQiLCJfaWQiLCJpc0xpa2VkIiwiX2hhbmRsZUxpa2VDYXJkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2VFbCIsImhhbmRsZURlbGV0ZSIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9yZW5kZXJMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsInNldElzTGlrZWQiLCJfaXNMaWtlZCIsImdldFZpZXciLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dEVscyIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJpbnB1dExpc3QiLCJldmVyeSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwicmVzZXQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJQb3B1cCIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRFbGVtZW50cyIsIl9idXR0b25FbGVtZW50IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbXMiLCJlbGVtZW50IiwicHJlcGVuZCIsInByb2ZpbGVFZGl0QnRuIiwicHJvZmlsZUVkaXRNb2RhbCIsImF2YXRhck1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwicHJldmlld0ltYWdlTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFyQnV0dG9uIiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEZvcm0iLCJwcm9maWxlVGl0bGVJbnB1dCIsImZpcnN0RWxlbWVudENoaWxkIiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJhZGRDYXJkQnV0dG9uIiwiZm9ybVNlbGVjdG9yIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2hVc2VySW5mbyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXIiLCJfcmVmMyIsImF2YXRhciIsImFkZENhcmQiLCJfcmVmNCIsImdldEluaXRpYWxDYXJkcyIsImRlbGV0ZUluaXRpYWxDYXJkcyIsImNhcmRJRCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJfaW1hZ2UiLCJfY2FwdGlvbiIsInNldEF0dHJpYnV0ZSIsInBvcHVwRGVsZXRlIiwiX2RlbGV0ZVBvcHVwIiwiX2hhbmRsZURlbGV0ZSIsInNldFN1Ym1pdEFjdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJ1c2VyQXZhdGFyIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsInNldFVzZXJJbmZvIiwidXNlckRhdGEiLCJzZXRBdmF0YXIiLCJzZWN0aW9uIiwiaW5pdGlhbENhcmRzIiwiY2FyZEVsZW1lbnQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImFkZENhcmRQb3BVcCIsImNhcmQiLCJjcmVhdGVDYXJkIiwiZmluYWxseSIsImVkaXRQcm9maWxlUG9wVXAiLCJuZXdVc2VyRGF0YSIsImVkaXRBdmF0YXJQb3B1cCIsIm5ld0F2YXRhciIsImNhcmREYXRhIiwiYWRkRm9ybVZhbGlkYXRvciIsInVzZXJJbmZvRGF0YSIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=