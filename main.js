!function(){"use strict";class e{constructor(e,t,r,s,i){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteCard=s,this.id=e._id,this.isLiked=e.isLiked,this._handleLikeCard=i}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)})),this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this))),this._cardImageEl.addEventListener("click",(()=>this._handleImageClick(this)))}handleDelete(){this._cardElement.remove(),this._cardElement=null}_renderLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}setIsLiked(e){this.isLiked=e,this._renderLikes()}_isLiked(){return this.isLiked}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".cards__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name+" Image",this._cardTitleEl.textContent=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._renderLikes(),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this.errorMessageElement.textContent=e.validationMessage,this.errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this.errorMessageElement.textContent=" ",this.errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._form.reset(),this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close")&&this.close()}))}}class s extends r{constructor(e,t){let{popupSelector:r}=e;super({popupSelector:r}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputElements=this._popupForm.querySelectorAll(".modal__input"),this._buttonElement=this._popupForm.querySelector(".modal__button")}open(){super.open()}close(){super.close(),this._popupForm.reset()}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}class i{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItems(e){this._container.prepend(e)}}document.querySelectorAll(".modal__form");const n=document.querySelector("#profile-edit-button"),o=document.querySelector("#profile-edit-modal"),a=document.querySelector("#avatar-edit-modal"),l=document.querySelector("#add-card-modal"),d=document.querySelector("#preview-image-modal"),c=a.querySelector(".modal__form"),u=document.querySelector(".profile__image-button"),h=(o.querySelector("#profile-modal-close"),l.querySelector("#add-card-modal-close"),d.querySelector("#preview-modal-close"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-name"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-edit-form")),_=l.querySelector("#add-card-form"),m=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".profile__add-button"),document.querySelector("#profile-title-input")),p=document.querySelector("#profile-description-input"),E=(_.querySelector(".modal__input_type_title"),_.querySelector(".modal__input_type_url"),document.querySelectorAll(".modal__close"),document.querySelector(".profile__add-button")),S={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},v=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}fetchUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}deleteInitialCards(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"PUT"}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"41597df2-eb93-4b41-8bf1-f4a542a9ea54","Content-Type":"application/json"}}),f=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._image=this._popupElement.querySelector(".modal__preview-image"),this._caption=this._popupElement.querySelector(".modal__preview-description")}open(e){super.open(),this._image.setAttribute("src",e._link),this._image.setAttribute("alt",e._name),this._caption.textContent=e._name}}({popupSelector:"#preview-image-modal"}),y=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._deletePopup=this._popupElement.querySelector("#modal__confirm"),this._buttonElement=this._deletePopup.querySelector(".modal__button")}setEventListeners(){this._popupElement.querySelector(".modal__button").addEventListener("click",(()=>{this._handleDelete()})),super.setEventListeners()}setSubmitAction(e){this._handleDelete=e}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}({popupSelector:"#delete-card-modal"}),b=new class{constructor(e,t,r){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,description:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.about}setAvatar(e){let{avatar:t}=e;this._avatar.src=t}}(".profile__title",".profile__description",".profile__image");let L;v.getInitialCards().then((t=>{L=new i({items:t,renderer:t=>{const r=new e(t,"#card-template",B,C,I);L.addItems(r.getView())}},".cards__list"),L.renderItems()})).catch((e=>{console.error(e)})),v.fetchUserInfo().then((e=>{b.setUserInfo({name:e.name,about:e.about}),b.setAvatar({avatar:e.avatar})})).catch((e=>{console.error(e)}));const k=new s({popupSelector:"#add-card-modal"},(function(t){k.renderLoading(!0),v.addCard({name:t.name,link:t.link}).then((t=>{const r=function(t){return new e(t,"#card-template",B,C,I).getView()}(t);L.addItems(r),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.renderLoading(!1)}))})),g=new s({popupSelector:"#profile-edit-modal"},(function(e){g.renderLoading(!0),v.editUserInfo(e).then((e=>{b.setUserInfo(e),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.renderLoading(!1)}))})),q=new s({popupSelector:"#avatar-edit-modal"},(function(e){q.renderLoading(!0),v.editAvatar({avatar:e.link}).then((e=>{b.setAvatar(e),q.close()})).catch((e=>{console.error(e)})).finally((()=>{q.renderLoading(!1)}))}));function C(e){y.open(),y.setSubmitAction((()=>{y.renderLoading(!0),v.deleteInitialCards(e.id).then((()=>{e.handleDelete(),y.close()})).catch((e=>{console.error(e)})).finally((()=>{y.renderLoading(!1)}))}))}function I(e){e.isLiked&&v.unlikeCard(e.id).then((()=>{e.setIsLiked(!1)})).catch((e=>{console.error(e)})),e.isLiked||v.likeCard(e.id).then((()=>{e.setIsLiked(!0)})).catch((e=>{console.error(e)}))}function B(e){f.open(e)}E.addEventListener("click",(()=>{k.open(),U.toggleButtonState()})),n.addEventListener("click",(()=>{const e=b.getUserInfo();m.value=e.name,p.value=e.about,g.open(),w.toggleButtonState()})),u.addEventListener("click",(()=>{q.open(),A.toggleButtonState()}));const w=new t(S,h),U=new t(S,_),A=new t(S,c);w.enableValidation(),U.enableValidation(),A.enableValidation(),k.setEventListeners(),g.setEventListeners(),f.setEventListeners(),y.setEventListeners(),q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxHQUcxQixDQXlDQSxTQUFTdkwsRUFBaUJrTSxHQUN4QjdFLEVBQWtCdEMsS0FBS21ILEVBQ3pCLENBSUFyRSxFQUFjNUcsaUJBQWlCLFNBQVMsS0FDdEN5SyxFQUFhM0csT0FDYm9ILEVBQWlCeEksbUJBQW1CLElBR3RDc0QsRUFBZWhHLGlCQUFpQixTQUFTLEtBQ3ZDLE1BQU1tTCxFQUFlN0IsRUFBU08sY0FDOUJwRCxFQUFrQnhCLE1BQVFrRyxFQUFhL0wsS0FDdkN1SCxFQUF3QjFCLE1BQVFrRyxFQUFhbkQsTUFDN0M2QyxFQUFpQi9HLE9BQ2pCc0gsRUFBa0IxSSxtQkFBbUIsSUFHdkM0RCxFQUFhdEcsaUJBQWlCLFNBQVMsS0FDckMrSyxFQUFnQmpILE9BQ2hCdUgsRUFBb0IzSSxtQkFBbUIsSUFJekMsTUFBTTBJLEVBQW9CLElBQUloSyxFQUFjQyxFQUFVa0YsR0FDaEQyRSxFQUFtQixJQUFJOUosRUFBY0MsRUFBVW1GLEdBQy9DNkUsRUFBc0IsSUFBSWpLLEVBQWNDLEVBQVVnRixHQVN4RCtFLEVBQWtCaEksbUJBQ2xCOEgsRUFBaUI5SCxtQkFDakJpSSxFQUFvQmpJLG1CQUVwQnFILEVBQWFyRyxvQkFDYnlHLEVBQWlCekcsb0JBQ2pCZ0MsRUFBa0JoQyxvQkFDbEI4RSxFQUFZOUUsb0JBQ1oyRyxFQUFnQjNHLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZURlbGV0ZUNhcmQsIGhhbmRsZUxpa2VDYXJkKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcbiAgICB0aGlzLmlkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkID0gaGFuZGxlTGlrZUNhcmQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCh0aGlzKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcylcbiAgICApO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMpXG4gICAgKTtcbiAgfVxuXG4gIGhhbmRsZURlbGV0ZSgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKXtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICAvLyBzZXQgaW5zdGFuY2UgdmFyaWFibGVcbiAgICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9pc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLmlzTGlrZWQ7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAvL2dldCB0aGUgY2FyZCB2aWV3XG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWUgKyBcIiBcIiArIFwiSW1hZ2VcIjtcbiAgICB0aGlzLl9jYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICB0aGlzLl9yZW5kZXJMaWtlcygpXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIC8vcmV0dXJuIHRoZSBjYXJkXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcblxuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiIFwiO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiAhaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpe1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpXG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgfVxuXG4gICAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICAgIH1cblxuICAgICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgfVxuXG4gICAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9LCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIH1cblxuICAgIG9wZW4oKSB7XG4gICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICBzdXBlci5jbG9zZSgpO1xuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICAgIH1cbiAgICBcbiAgICAgIHJlbmRlckl0ZW1zKCkge1xuICAgICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIFxuICAgICAgYWRkSXRlbXMoZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9IiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWJ1dHRvblwiKVxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbENsb3NlID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLW1vZGFsLWNsb3NlXCJcbik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2UgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjYWRkLWNhcmQtbW9kYWwtY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxDbG9zZSA9IHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3ByZXZpZXctbW9kYWwtY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld05hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcbik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcblxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCJcbik7XG5leHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91cmxcIik7XG5cbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZVwiKTtcblxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59OyIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCAnLi4vcGFnZXMvaW5kZXguY3NzJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanNcIlxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIGNhcmRMaXN0RWwsXG4gIHByb2ZpbGVFZGl0QnRuLFxuICBwcm9maWxlRWRpdEZvcm0sXG4gIGFkZENhcmRGb3JtLFxuICBhZGRDYXJkTW9kYWwsXG4gIGF2YXRhckJ1dHRvbixcbiAgYWRkQ2FyZEJ1dHRvbixcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxuICBhdmF0YXJGb3JtLFxuICBzZXR0aW5ncyxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuLy9jb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsICcjY2FyZC10ZW1wbGF0ZScpO1xuLy9jYXJkLl9nZXRWaWV3KCk7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjQxNTk3ZGYyLWViOTMtNGI0MS04YmYxLWY0YTU0MmE5ZWE1NFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gIH1cbn0pO1xuXG4vL0NsYXNzIEluc3RhbmNlc1xuY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoeyBwb3B1cFNlbGVjdG9yOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIgfSk7XG5jb25zdCBwb3B1cERlbGV0ZSA9IG5ldyBQb3B1cFdpdGhEZWxldGUoeyBwb3B1cFNlbGVjdG9yOiBcIiNkZWxldGUtY2FyZC1tb2RhbFwiIH0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLCBcIi5wcm9maWxlX19pbWFnZVwiKTtcblxubGV0IHNlY3Rpb247XG5cbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChpbml0aWFsQ2FyZHMpID0+IHtcbiAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgIHtcbiAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcbiAgICAgICAgICBkYXRhLFxuICAgICAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICAgICAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgICAgICAgIGhhbmRsZURlbGV0ZSxcbiAgICAgICAgICBoYW5kbGVMaWtlQ2FyZFxuICAgICAgICApO1xuICAgICAgICBzZWN0aW9uLmFkZEl0ZW1zKGNhcmRFbGVtZW50LmdldFZpZXcoKSk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgXCIuY2FyZHNfX2xpc3RcIlxuICApO1xuICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG59KVxuLmNhdGNoKChlcnIpID0+IHtcbiAgY29uc29sZS5lcnJvcihlcnIpO1xufSk7XG5hcGkuZmV0Y2hVc2VySW5mbygpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcbiAgfSk7XG4gIHVzZXJJbmZvLnNldEF2YXRhcih7IGF2YXRhcjogdXNlckRhdGEuYXZhdGFyIH0pO1xufSlcbi5jYXRjaCgoZXJyKSA9PiB7XG4gIGNvbnNvbGUuZXJyb3IoZXJyKTtcbn0pO1xuXG4gICAgY29uc3QgYWRkQ2FyZFBvcFVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgICB7IHBvcHVwU2VsZWN0b3I6IFwiI2FkZC1jYXJkLW1vZGFsXCIgfSxcbiAgICAgIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0XG4gICAgKTtcblxuICAgIGNvbnN0IGVkaXRQcm9maWxlUG9wVXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgICAgIHsgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIgfSxcbiAgICAgIGhhbmRsZVByb2ZpbGVFZGl0Rm9ybVN1Ym1pdFxuICAgICk7XG5cbiAgICBjb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgICAgIHsgcG9wdXBTZWxlY3RvcjogXCIjYXZhdGFyLWVkaXQtbW9kYWxcIiB9LFxuICAgICAgaGFuZGxlQXZhdGFyU3VibWl0XG4gICAgKTtcblxuLypGdW5jdGlvbnMqL1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZSxcbiAgICBoYW5kbGVMaWtlQ2FyZFxuICApLmdldFZpZXcoKTtcbiAgcmV0dXJuIGNhcmQ7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRBdmF0YXIoeyBhdmF0YXI6IGlucHV0VmFsdWVzLmxpbmsgfSlcbiAgICAudGhlbigobmV3QXZhdGFyKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIobmV3QXZhdGFyKTtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlKGNhcmQpIHtcbiAgcG9wdXBEZWxldGUub3BlbigpO1xuICBwb3B1cERlbGV0ZS5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIHBvcHVwRGVsZXRlLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlSW5pdGlhbENhcmRzKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlKCk7XG4gICAgICAgIHBvcHVwRGVsZXRlLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcG9wdXBEZWxldGUucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDYXJkKGNhcmQpIHtcbiAgaWYgKGNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLnVubGlrZUNhcmQoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5zZXRJc0xpa2VkKGZhbHNlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuICBpZiAoIWNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuc2V0SXNMaWtlZCh0cnVlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBhZGRDYXJkUG9wVXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmFkZENhcmQoe1xuICAgICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcbiAgICAgIGxpbms6IGlucHV0VmFsdWVzLmxpbmssXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gICAgICBzZWN0aW9uLmFkZEl0ZW1zKGNhcmQpO1xuICAgICAgYWRkQ2FyZFBvcFVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZFBvcFVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5cblxuLy9FdmVudCBIYW5kbGVyc1xuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGVkaXRQcm9maWxlUG9wVXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcylcbiAgICAudGhlbigobmV3VXNlckRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5ld1VzZXJEYXRhKTtcbiAgICAgIGVkaXRQcm9maWxlUG9wVXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UHJvZmlsZVBvcFVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XG4gIHByZXZpZXdJbWFnZU1vZGFsLm9wZW4oY2FyZERhdGEpO1xufVxuXG4vKkV2ZW50IExpc3RlbmVycyovXG4vL2FkZCBuZXcgQ2FyZCBidXR0b25cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkQ2FyZFBvcFVwLm9wZW4oKTtcbiAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG5cbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJJbmZvRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlckluZm9EYXRhLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckluZm9EYXRhLmFib3V0O1xuICBlZGl0UHJvZmlsZVBvcFVwLm9wZW4oKTtcbiAgZWRpdEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbn0pO1xuXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG5cblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcHJvZmlsZUVkaXRGb3JtKTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkQ2FyZEZvcm0pO1xuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhdmF0YXJGb3JtKTtcblxuLy9mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIC8vY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAvL3NlY3Rpb24uYWRkSXRlbXMoY2FyZCk7XG4vL31cblxuLy9WYWxpZGF0aW9uXG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmFkZENhcmRQb3BVcC5zZXRFdmVudExpc3RlbmVycygpO1xuZWRpdFByb2ZpbGVQb3BVcC5zZXRFdmVudExpc3RlbmVycygpO1xucHJldmlld0ltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRGVsZXRlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGl7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuX2NoZWNrUmVzcG9uc2UocmVzKXtcbiAgaWYgKHJlcy5vaykge1xuICAgIHJldHVybiByZXMuanNvbigpO1xuICB9XG4gIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbn1cblxuICBmZXRjaFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBkZWxldGVJbml0aWFsQ2FyZHMoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1bmxpa2VDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG4gICAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctZGVzY3JpcHRpb25cIik7XG4gICAgfVxuXG4gICAgb3BlbihkYXRhKSB7XG4gICAgICBzdXBlci5vcGVuKCk7XG4gICAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgZGF0YS5fbGluayk7XG4gICAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgZGF0YS5fbmFtZSk7XG4gICAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5fbmFtZTtcbiAgICB9XG4gIH0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXB3aXRoRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9kZWxldGVQb3B1cCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX19jb25maXJtXCIpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9kZWxldGVQb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGUoKTtcbiAgICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oaGFuZGxlRGVsZXRlKSB7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlID0gaGFuZGxlRGVsZXRlO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH1cbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCB1c2VyQXZhdGFyKSB7XG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhcik7XG4gICAgICB9XG5cbiAgICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBzZXRVc2VySW5mbyh1c2VyRGF0YSkge1xuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgICAgIH1cblxuICAgICAgc2V0QXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgICAgIH1cbiAgICB9Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkIiwiaWQiLCJfaWQiLCJpc0xpa2VkIiwiX2hhbmRsZUxpa2VDYXJkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2VFbCIsImhhbmRsZURlbGV0ZSIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9yZW5kZXJMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsInNldElzTGlrZWQiLCJfaXNMaWtlZCIsImdldFZpZXciLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dEVscyIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJpbnB1dExpc3QiLCJldmVyeSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwicmVzZXQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJQb3B1cCIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRFbGVtZW50cyIsIl9idXR0b25FbGVtZW50IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbXMiLCJlbGVtZW50IiwicHJlcGVuZCIsInByb2ZpbGVFZGl0QnRuIiwicHJvZmlsZUVkaXRNb2RhbCIsImF2YXRhck1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwicHJldmlld0ltYWdlTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFyQnV0dG9uIiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEZvcm0iLCJwcm9maWxlVGl0bGVJbnB1dCIsImZpcnN0RWxlbWVudENoaWxkIiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJhZGRDYXJkQnV0dG9uIiwiZm9ybVNlbGVjdG9yIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2hVc2VySW5mbyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXIiLCJfcmVmMyIsImF2YXRhciIsImFkZENhcmQiLCJfcmVmNCIsImdldEluaXRpYWxDYXJkcyIsImRlbGV0ZUluaXRpYWxDYXJkcyIsImNhcmRJRCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJfaW1hZ2UiLCJfY2FwdGlvbiIsInNldEF0dHJpYnV0ZSIsInBvcHVwRGVsZXRlIiwiX2RlbGV0ZVBvcHVwIiwiX2hhbmRsZURlbGV0ZSIsInNldFN1Ym1pdEFjdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJ1c2VyQXZhdGFyIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsInNldFVzZXJJbmZvIiwidXNlckRhdGEiLCJzZXRBdmF0YXIiLCJzZWN0aW9uIiwiaW5pdGlhbENhcmRzIiwiY2FyZEVsZW1lbnQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImFkZENhcmRQb3BVcCIsImNhcmQiLCJjcmVhdGVDYXJkIiwiZmluYWxseSIsImVkaXRQcm9maWxlUG9wVXAiLCJuZXdVc2VyRGF0YSIsImVkaXRBdmF0YXJQb3B1cCIsIm5ld0F2YXRhciIsImNhcmREYXRhIiwiYWRkRm9ybVZhbGlkYXRvciIsInVzZXJJbmZvRGF0YSIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=