!function(){"use strict";class e{constructor(e,t,r,s,i){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteCard=s,this.id=e._id,this.isLiked=e.isLiked,this._handleLikeCard=i}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)})),this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this))),this._cardImageEl.addEventListener("click",(()=>this._handleImageClick(this)))}handleDelete(){this._cardElement.remove(),this._cardElement=null}_renderLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}setIsLiked(e){this.isLiked=e,this._renderLikes()}_isLiked(){return this.isLiked}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".cards__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name+" Image",this._cardTitleEl.textContent=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._renderLikes(),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this.errorMessageElement.textContent=e.validationMessage,this.errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this.errorMessageElement.textContent=" ",this.errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._form.reset(),this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close")&&this.close()}))}}class s extends r{constructor(e,t){let{popupSelector:r}=e;super({popupSelector:r}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputElements=this._popupForm.querySelectorAll(".modal__input"),this._buttonElement=this._popupForm.querySelector(".modal__button")}open(){super.open()}close(){super.close(),this._popupForm.reset()}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}class i{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItems(e){this._container.prepend(e)}}document.querySelectorAll(".modal__form");const n=document.querySelector("#profile-edit-button"),o=document.querySelector("#profile-edit-modal"),a=document.querySelector("#avatar-edit-modal"),l=document.querySelector("#add-card-modal"),d=document.querySelector("#preview-image-modal"),c=a.querySelector(".modal__form"),u=document.querySelector(".profile__image-button"),h=(o.querySelector("#profile-modal-close"),l.querySelector("#add-card-modal-close"),d.querySelector("#preview-modal-close"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-name"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-edit-form")),_=l.querySelector("#add-card-form"),m=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".profile__add-button"),document.querySelector("#profile-title-input")),p=document.querySelector("#profile-description-input"),E=(_.querySelector(".modal__input_type_title"),_.querySelector(".modal__input_type_url"),document.querySelectorAll(".modal__close"),document.querySelector(".profile__add-button")),S={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},v=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}fetchUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}deleteInitialCards(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"PUT"}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"41597df2-eb93-4b41-8bf1-f4a542a9ea54","Content-Type":"application/json"}}),f=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._image=this._popupElement.querySelector(".modal__preview-image"),this._caption=this._popupElement.querySelector(".modal__preview-description")}open(e){super.open(),this._image.setAttribute("src",e._link),this._image.setAttribute("alt",e._name),this._caption.textContent=e._name}}({popupSelector:"#preview-image-modal"}),b=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._deletePopup=this._popupElement.querySelector("#modal__confirm"),this._buttonElement=this._deletePopup.querySelector(".modal__button")}setEventListeners(){this._popupElement.querySelector(".modal__button").addEventListener("click",(()=>{this._handleDelete()})),super.setEventListeners()}setSubmitAction(e){this._handleDelete=e}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}({popupSelector:"#delete-card-modal"}),y=new class{constructor(e,t,r){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.about}setAvatar(e){let{avatar:t}=e;this._avatar.src=t}}(".profile__title",".profile__description",".profile__image");let L;v.getInitialCards().then((t=>{L=new i({items:t,renderer:t=>{const r=new e(t,"#card-template",B,C,I);L.addItems(r.getView())}},".cards__list"),L.renderItems()})).catch((e=>{console.error(e)})),v.fetchUserInfo().then((e=>{y.setUserInfo({name:e.name,about:e.about}),y.setAvatar({avatar:e.avatar})})).catch((e=>{console.error(e)}));const k=new s({popupSelector:"#add-card-modal"},(function(t){k.renderLoading(!0),v.addCard({name:t.name,link:t.link}).then((t=>{const r=function(t){return new e(t,"#card-template",B,C,I).getView()}(t);L.addItems(r),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.renderLoading(!1)}))})),g=new s({popupSelector:"#profile-edit-modal"},(function(e){g.renderLoading(!0),v.editUserInfo(e).then((e=>{y.setUserInfo(e),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.renderLoading(!1)}))})),q=new s({popupSelector:"#avatar-edit-modal"},(function(e){q.renderLoading(!0),v.editAvatar({avatar:e.link}).then((e=>{y.setAvatar(e),q.close()})).catch((e=>{console.error(e)})).finally((()=>{q.renderLoading(!1)}))}));function C(e){b.open(),b.setSubmitAction((()=>{b.renderLoading(!0),v.deleteInitialCards(e.id).then((()=>{e.handleDelete(),b.close()})).catch((e=>{console.error(e)})).finally((()=>{b.renderLoading(!1)}))}))}function I(e){e.isLiked&&v.unlikeCard(e.id).then((()=>{e.setIsLiked(!1)})).catch((e=>{console.error(e)})),e.isLiked||v.likeCard(e.id).then((()=>{e.setIsLiked(!0)})).catch((e=>{console.error(e)}))}function B(e){f.open(e)}E.addEventListener("click",(()=>{k.open(),U.toggleButtonState()})),n.addEventListener("click",(()=>{const e=y.getUserInfo();m.value=e.name,p.value=e.about,g.open(),w.toggleButtonState()})),u.addEventListener("click",(()=>{q.open(),A.toggleButtonState()}));const w=new t(S,h),U=new t(S,_),A=new t(S,c);w.enableValidation(),U.enableValidation(),A.enableValidation(),k.setEventListeners(),g.setEventListeners(),f.setEventListeners(),b.setEventListeners(),q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQVlDLEVBQU1DLEVBQWNDLEVBQWtCQyxFQUFrQkMsR0FDbEVDLEtBQUtDLE1BQVFOLEVBQUtPLEtBQ2xCRixLQUFLRyxNQUFRUixFQUFLUyxLQUNsQkosS0FBS0ssY0FBZ0JULEVBQ3JCSSxLQUFLTSxrQkFBb0JULEVBQ3pCRyxLQUFLTyxrQkFBb0JULEVBQ3pCRSxLQUFLUSxHQUFLYixFQUFLYyxJQUNmVCxLQUFLVSxRQUFVZixFQUFLZSxRQUNwQlYsS0FBS1csZ0JBQWtCWixDQUN6QixDQUVBYSxrQkFBQUEsR0FDRVosS0FBS2EsWUFBWUMsaUJBQWlCLFNBQVMsS0FFekNkLEtBQUtXLGdCQUFnQlgsS0FBSyxJQUc1QkEsS0FBS2UsY0FBY0QsaUJBQWlCLFNBQVMsSUFDM0NkLEtBQUtPLGtCQUFrQlAsUUFHekJBLEtBQUtnQixhQUFhRixpQkFBaUIsU0FBUyxJQUMxQ2QsS0FBS00sa0JBQWtCTixPQUUzQixDQUVBaUIsWUFBQUEsR0FDRWpCLEtBQUtrQixhQUFhQyxTQUNsQm5CLEtBQUtrQixhQUFlLElBQ3RCLENBRUFFLFlBQUFBLEdBQ01wQixLQUFLVSxRQUNQVixLQUFLYSxZQUFZUSxVQUFVQyxJQUFJLDRCQUUvQnRCLEtBQUthLFlBQVlRLFVBQVVGLE9BQU8sMkJBRXRDLENBRUFJLFVBQUFBLENBQVdiLEdBRVJWLEtBQUtVLFFBQVVBLEVBQ2ZWLEtBQUtvQixjQUNSLENBRUFJLFFBQUFBLEdBQ0UsT0FBT3hCLEtBQUtVLE9BQ2QsQ0FFQWUsT0FBQUEsR0FvQk0sT0FuQkp6QixLQUFLa0IsYUFBZVEsU0FDakJDLGNBQWMzQixLQUFLSyxlQUNuQnVCLFFBQVFELGNBQWMsU0FDdEJFLFdBQVUsR0FFYjdCLEtBQUtnQixhQUFlaEIsS0FBS2tCLGFBQWFTLGNBQWMsZ0JBQ3BEM0IsS0FBSzhCLGFBQWU5QixLQUFLa0IsYUFBYVMsY0FBYyxpQkFFcEQzQixLQUFLZ0IsYUFBYWUsSUFBTS9CLEtBQUtHLE1BQzdCSCxLQUFLZ0IsYUFBYWdCLElBQU1oQyxLQUFLQyxNQUFMRCxTQUN4QkEsS0FBSzhCLGFBQWFHLFlBQWNqQyxLQUFLQyxNQUNyQ0QsS0FBS2EsWUFBY2IsS0FBS2tCLGFBQWFTLGNBQWMsc0JBQ25EM0IsS0FBS2UsY0FBZ0JmLEtBQUtrQixhQUFhUyxjQUNyQyx3QkFHRTNCLEtBQUtvQixlQUNMcEIsS0FBS1kscUJBRUVaLEtBQUtrQixZQUVsQixFQ3hFYSxNQUFNZ0IsRUFDbkJ4QyxXQUFBQSxDQUFZeUMsRUFBVUMsR0FDcEJwQyxLQUFLcUMsZUFBaUJGLEVBQVNHLGNBQy9CdEMsS0FBS3VDLHNCQUF3QkosRUFBU0sscUJBQ3RDeEMsS0FBS3lDLHFCQUF1Qk4sRUFBU08sb0JBQ3JDMUMsS0FBSzJDLGlCQUFtQlIsRUFBU1MsZ0JBQ2pDNUMsS0FBSzZDLFlBQWNWLEVBQVNXLFdBQzVCOUMsS0FBSytDLE1BQVFYLENBQ2YsQ0FFQVksZUFBQUEsQ0FBZ0JDLEdBQ2RqRCxLQUFLa0Qsb0JBQXNCbEQsS0FBSytDLE1BQU1wQixjQUFlLElBQUdzQixFQUFRekMsWUFDaEV5QyxFQUFRNUIsVUFBVUMsSUFBSXRCLEtBQUsyQyxrQkFDM0IzQyxLQUFLa0Qsb0JBQW9CakIsWUFBY2dCLEVBQVFFLGtCQUMvQ25ELEtBQUtrRCxvQkFBb0I3QixVQUFVQyxJQUFJdEIsS0FBSzZDLFlBQzlDLENBRUFPLGVBQUFBLENBQWdCSCxHQUNkakQsS0FBS2tELG9CQUFzQmxELEtBQUsrQyxNQUFNcEIsY0FBZSxJQUFHc0IsRUFBUXpDLFlBQ2hFeUMsRUFBUTVCLFVBQVVGLE9BQU9uQixLQUFLMkMsa0JBQzlCM0MsS0FBS2tELG9CQUFvQmpCLFlBQWMsSUFDdkNqQyxLQUFLa0Qsb0JBQW9CN0IsVUFBVUYsT0FBT25CLEtBQUs2QyxZQUNqRCxDQUVBUSxtQkFBQUEsQ0FBb0JKLEdBQ2xCLElBQUtBLEVBQVFLLFNBQVNDLE1BQ3BCLE9BQU92RCxLQUFLZ0QsZ0JBQWdCQyxHQUc5QmpELEtBQUtvRCxnQkFBZ0JILEVBQ3ZCLENBRUFPLGlCQUFBQSxHQUNNeEQsS0FBS3lELGlCQUFpQnpELEtBQUswRCxXQUM3QjFELEtBQUsyRCxpQkFJUDNELEtBQUs0RCxjQUFjdkMsVUFBVUYsT0FBT25CLEtBQUt5QyxzQkFDekN6QyxLQUFLNEQsY0FBY0MsVUFBVyxFQUNoQyxDQUVBSixnQkFBQUEsQ0FBaUJLLEdBQ2YsT0FBUUEsRUFBVUMsT0FBT2QsR0FBWUEsRUFBUUssU0FBU0MsT0FDeEQsQ0FFQTNDLGtCQUFBQSxHQUNFWixLQUFLMEQsVUFBWSxJQUFJMUQsS0FBSytDLE1BQU1pQixpQkFBaUJoRSxLQUFLcUMsaUJBQ3REckMsS0FBSzRELGNBQWdCNUQsS0FBSytDLE1BQU1wQixjQUFjM0IsS0FBS3VDLHVCQUVuRHZDLEtBQUswRCxVQUFVTyxTQUFTaEIsSUFDdEJBLEVBQVFuQyxpQkFBaUIsU0FBUyxLQUNoQ2QsS0FBS3FELG9CQUFvQkosR0FDekJqRCxLQUFLd0QsbUJBQW1CLEdBQ3hCLEdBRU4sQ0FFQUcsYUFBQUEsR0FDRTNELEtBQUs0RCxjQUFjdkMsVUFBVUMsSUFBSXRCLEtBQUt5QyxzQkFDdEN6QyxLQUFLNEQsY0FBY0MsVUFBVyxDQUNoQyxDQUVBSyxnQkFBQUEsR0FDRWxFLEtBQUsrQyxNQUFNakMsaUJBQWlCLFVBQVdxRCxJQUNyQ0EsRUFBSUMsZ0JBQWdCLElBSXRCcEUsS0FBS1ksb0JBQ1AsQ0FFQXlELGVBQUFBLEdBQ0VyRSxLQUFLK0MsTUFBTXVCLFFBQ1h0RSxLQUFLdUUscUJBQ0x2RSxLQUFLMEQsVUFBVU8sU0FBU2hCLElBQ3RCakQsS0FBS29ELGdCQUFnQkgsRUFBUSxHQUVqQyxFQzlFYSxNQUFNdUIsRUFDakI5RSxXQUFBQSxDQUFXK0UsR0FBb0IsSUFBbkIsY0FBRUMsR0FBZUQsRUFDekJ6RSxLQUFLMkUsY0FBZ0JqRCxTQUFTQyxjQUFjK0MsRUFDOUMsQ0FFQUUsSUFBQUEsR0FDRTVFLEtBQUsyRSxjQUFjdEQsVUFBVUMsSUFBSSxnQkFDakNJLFNBQVNaLGlCQUFpQixRQUFTZCxLQUFLNkUsZ0JBQzFDLENBRUFDLEtBQUFBLEdBQ0U5RSxLQUFLMkUsY0FBY3RELFVBQVVGLE9BQU8sZ0JBQ3BDTyxTQUFTcUQsb0JBQW9CLFFBQVMvRSxLQUFLNkUsZ0JBQzdDLENBRUFBLGdCQUFtQkcsSUFDSCxXQUFWQSxFQUFFQyxLQUNKakYsS0FBSzhFLE9BQ1AsRUFHRkksaUJBQUFBLEdBQ0VsRixLQUFLMkUsY0FBYzdELGlCQUFpQixTQUFVcUQsSUFDeENBLEVBQUlnQixPQUFPOUQsVUFBVStELFNBQVMsaUJBQ2hDcEYsS0FBSzhFLE9BQ1AsSUFHRjlFLEtBQUsyRSxjQUFjN0QsaUJBQWlCLFNBQVVxRCxJQUN4Q0EsRUFBSWdCLE9BQU85RCxVQUFVK0QsU0FBUyxpQkFDaENwRixLQUFLOEUsT0FDUCxHQUVKLEVDL0JTLE1BQU1PLFVBQXNCYixFQUN2QzlFLFdBQUFBLENBQVcrRSxFQUFvQmEsR0FBa0IsSUFBckMsY0FBRVosR0FBZUQsRUFDM0JjLE1BQU0sQ0FBRWIsa0JBQ1IxRSxLQUFLd0YsV0FBYXhGLEtBQUsyRSxjQUFjaEQsY0FBYyxnQkFDbkQzQixLQUFLeUYsa0JBQW9CSCxFQUN6QnRGLEtBQUswRixlQUFpQjFGLEtBQUt3RixXQUFXeEIsaUJBQWlCLGlCQUN2RGhFLEtBQUsyRixlQUFpQjNGLEtBQUt3RixXQUFXN0QsY0FBYyxpQkFDdEQsQ0FFQWlELElBQUFBLEdBQ0VXLE1BQU1YLE1BQ1IsQ0FFQUUsS0FBQUEsR0FDRVMsTUFBTVQsUUFDTjlFLEtBQUt3RixXQUFXbEIsT0FDbEIsQ0FFQXNCLGVBQUFBLEdBQ0UsTUFBTUMsRUFBYyxDQUFDLEVBSXJCLE9BSEE3RixLQUFLMEYsZUFBZXpCLFNBQVM2QixJQUMzQkQsRUFBWUMsRUFBTTVGLE1BQVE0RixFQUFNQyxLQUFLLElBRWhDRixDQUNULENBRUFYLGlCQUFBQSxHQUNFSyxNQUFNTCxvQkFDTmxGLEtBQUt3RixXQUFXMUUsaUJBQWlCLFVBQVdrRSxJQUMxQ0EsRUFBRVosaUJBQ0ZwRSxLQUFLeUYsa0JBQWtCekYsS0FBSzRGLGtCQUFrQixHQUVsRCxDQUVBSSxhQUFBQSxDQUFjQyxHQUVWakcsS0FBSzJGLGVBQWUxRCxZQURsQmdFLEVBQ2dDLFlBRUEsTUFFdEMsRUMxQ1csTUFBTUMsRUFDakJ4RyxXQUFBQSxDQUFXK0UsRUFBc0IwQixHQUFtQixJQUF4QyxNQUFFQyxFQUFLLFNBQUVDLEdBQVU1QixFQUMzQnpFLEtBQUtzRyxPQUFTRixFQUNkcEcsS0FBS3VHLFVBQVlGLEVBQ2pCckcsS0FBS3dHLFdBQWE5RSxTQUFTQyxjQUFjd0UsRUFDM0MsQ0FFQU0sV0FBQUEsR0FDRXpHLEtBQUtzRyxPQUFPckMsU0FBU3lDLElBQ25CMUcsS0FBS3VHLFVBQVVHLEVBQUssR0FFeEIsQ0FFQUMsUUFBQUEsQ0FBU0MsR0FDUDVHLEtBQUt3RyxXQUFXSyxRQUFRRCxFQUMxQixFQ1lrQmxGLFNBQVNzQyxpQkFBaUIsZ0JBM0IzQyxNQTRCTThDLEVBQWlCcEYsU0FBU0MsY0FBYyx3QkFDeENvRixFQUFtQnJGLFNBQVNDLGNBQWMsdUJBQzFDcUYsRUFBY3RGLFNBQVNDLGNBQWMsc0JBQ3JDc0YsRUFBZXZGLFNBQVNDLGNBQWMsbUJBQ3RDdUYsRUFBb0J4RixTQUFTQyxjQUFjLHdCQUMzQ3dGLEVBQWFILEVBQVlyRixjQUFjLGdCQUN2Q3lGLEVBQWUxRixTQUFTQyxjQUFjLDBCQWlCdEMwRixHQWhCb0JOLEVBQWlCcEYsY0FDaEQsd0JBRStCc0YsRUFBYXRGLGNBQzVDLHlCQUUrQnVGLEVBQWtCdkYsY0FDakQsd0JBRTRCRCxTQUFTQyxjQUFjLHlCQUN4QkQsU0FBU0MsY0FBYyx3QkFDeEJELFNBQVNDLGNBQWMsbUJBQ2pCRCxTQUFTQyxjQUN6Qyx5QkFHNkJELFNBQVNDLGNBQWMsdUJBQ3pDMkYsRUFBY0wsRUFBYXRGLGNBQWMsa0JBT3pDNEYsR0FOYTdGLFNBQVNDLGNBQWMsZ0JBRS9DRCxTQUFTQyxjQUFjLGtCQUFrQkMsUUFBUTRGLGtCQUVuQjlGLFNBQVNDLGNBQWMsd0JBRXRCRCxTQUFTQyxjQUFjLHlCQUMzQzhGLEVBQTBCL0YsU0FBU0MsY0FDOUMsOEJBU1crRixHQVBpQkosRUFBWTNGLGNBQ3hDLDRCQUUwQjJGLEVBQVkzRixjQUFjLDBCQUUxQkQsU0FBU3NDLGlCQUFpQixpQkFFekJ0QyxTQUFTQyxjQUFjLHlCQUV2Q1EsRUFBVyxDQUN0QndGLGFBQWMsZUFDZHJGLGNBQWUsZ0JBQ2ZFLHFCQUFzQixpQkFDdEJFLG9CQUFxQix5QkFDckJFLGdCQUFpQiwwQkFDakJFLFdBQVksd0JDL0NSOEUsRUFBTSxJQy9CRyxNQUNibEksV0FBQUEsQ0FBVytFLEdBQXVCLElBQXRCLFFBQUVvRCxFQUFPLFFBQUVDLEdBQVNyRCxFQUM5QnpFLEtBQUsrSCxTQUFXRixFQUNoQjdILEtBQUtnSSxTQUFXRixDQUNsQixDQUVGRyxjQUFBQSxDQUFlQyxHQUNiLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssU0FDdEMsQ0FFRUMsYUFBQUEsR0FDRSxPQUFPQyxNQUFPLEdBQUV6SSxLQUFLK0gsb0JBQXFCLENBQ3hDVyxPQUFRLE1BQ1JaLFFBQVM5SCxLQUFLZ0ksV0FDYlcsS0FBSzNJLEtBQUtpSSxlQUNmLENBRUFXLFlBQUFBLENBQVlDLEdBQWtCLElBQWpCLEtBQUUzSSxFQUFJLE1BQUU0SSxHQUFPRCxFQUMxQixPQUFPSixNQUFPLEdBQUV6SSxLQUFLK0gsb0JBQXFCLENBQ3hDVyxPQUFRLFFBQ1JaLFFBQVM5SCxLQUFLZ0ksU0FDZGUsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQi9JLE9BQ0E0SSxZQUVESCxLQUFLM0ksS0FBS2lJLGVBQ2YsQ0FFQWlCLFVBQUFBLENBQVVDLEdBQWEsSUFBWixPQUFFQyxHQUFRRCxFQUNuQixPQUFPVixNQUFPLEdBQUV6SSxLQUFLK0gsMkJBQTRCLENBQy9DVyxPQUFRLFFBQ1JaLFFBQVM5SCxLQUFLZ0ksU0FDZGUsS0FBTUMsS0FBS0MsVUFBVSxDQUFFRyxhQUN0QlQsS0FBSzNJLEtBQUtpSSxlQUNmLENBRUFvQixPQUFBQSxDQUFPQyxHQUFpQixJQUFoQixLQUFFcEosRUFBSSxLQUFFRSxHQUFNa0osRUFDcEIsT0FBT2IsTUFBTyxHQUFFekksS0FBSytILGlCQUFrQixDQUNyQ1csT0FBUSxPQUNSWixRQUFTOUgsS0FBS2dJLFNBQ2RlLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkIvSSxPQUNBRSxXQUVEdUksS0FBSzNJLEtBQUtpSSxlQUNmLENBRUFzQixlQUFBQSxHQUNFLE9BQU9kLE1BQU8sR0FBRXpJLEtBQUsrSCxpQkFBa0IsQ0FDckNELFFBQVM5SCxLQUFLZ0ksV0FDYlcsS0FBSzNJLEtBQUtpSSxlQUNmLENBRUF1QixrQkFBQUEsQ0FBbUJDLEdBQ2pCLE9BQU9oQixNQUFPLEdBQUV6SSxLQUFLK0gsa0JBQWtCMEIsSUFBVSxDQUMvQzNCLFFBQVM5SCxLQUFLZ0ksU0FDZFUsT0FBUSxXQUNQQyxLQUFLM0ksS0FBS2lJLGVBQ2YsQ0FFQXlCLFFBQUFBLENBQVNELEdBQ1AsT0FBT2hCLE1BQU8sR0FBRXpJLEtBQUsrSCxrQkFBa0IwQixVQUFnQixDQUNyRDNCLFFBQVM5SCxLQUFLZ0ksU0FDZFUsT0FBUSxRQUNQQyxLQUFLM0ksS0FBS2lJLGVBQ2YsQ0FFQTBCLFVBQUFBLENBQVdGLEdBQ1QsT0FBT2hCLE1BQU8sR0FBRXpJLEtBQUsrSCxrQkFBa0IwQixVQUFnQixDQUNyRDNCLFFBQVM5SCxLQUFLZ0ksU0FDZFUsT0FBUSxXQUNQQyxLQUFLM0ksS0FBS2lJLGVBQ2YsR0Q1Q2tCLENBQ2xCSixRQUFTLGtEQUNUQyxRQUFTLENBQ1A4QixjQUFlLHVDQUNmLGVBQWdCLHNCQUtkMUMsRUFBb0IsSUV0Q1gsY0FBNkIxQyxFQUN4QzlFLFdBQUFBLENBQVcrRSxHQUFvQixJQUFuQixjQUFFQyxHQUFlRCxFQUMzQmMsTUFBTSxDQUFFYixrQkFDUjFFLEtBQUs2SixPQUFTN0osS0FBSzJFLGNBQWNoRCxjQUFjLHlCQUMvQzNCLEtBQUs4SixTQUFXOUosS0FBSzJFLGNBQWNoRCxjQUFjLDhCQUNuRCxDQUVBaUQsSUFBQUEsQ0FBS2pGLEdBQ0g0RixNQUFNWCxPQUNONUUsS0FBSzZKLE9BQU9FLGFBQWEsTUFBT3BLLEVBQUtRLE9BQ3JDSCxLQUFLNkosT0FBT0UsYUFBYSxNQUFPcEssRUFBS00sT0FDckNELEtBQUs4SixTQUFTN0gsWUFBY3RDLEVBQUtNLEtBQ25DLEdGMEJ5QyxDQUFFeUUsY0FBZSx5QkFDeERzRixFQUFjLElHdkNMLGNBQThCeEYsRUFDM0M5RSxXQUFBQSxDQUFXK0UsR0FBb0IsSUFBbkIsY0FBRUMsR0FBZUQsRUFDM0JjLE1BQU0sQ0FBRWIsa0JBQ1IxRSxLQUFLaUssYUFBZWpLLEtBQUsyRSxjQUFjaEQsY0FBYyxtQkFDckQzQixLQUFLMkYsZUFBaUIzRixLQUFLaUssYUFBYXRJLGNBQWMsaUJBQ3hELENBRUF1RCxpQkFBQUEsR0FDRWxGLEtBQUsyRSxjQUNGaEQsY0FBYyxrQkFDZGIsaUJBQWlCLFNBQVMsS0FDekJkLEtBQUtrSyxlQUFlLElBRXhCM0UsTUFBTUwsbUJBQ1IsQ0FFQWlGLGVBQUFBLENBQWdCbEosR0FDZGpCLEtBQUtrSyxjQUFnQmpKLENBQ3ZCLENBRUErRSxhQUFBQSxDQUFjQyxHQUVWakcsS0FBSzJGLGVBQWUxRCxZQURsQmdFLEVBQ2dDLFlBRUEsTUFFdEMsR0hhc0MsQ0FBRXZCLGNBQWUsdUJBRW5EMEYsRUFBVyxJSTNDRixNQUNYMUssV0FBQUEsQ0FBWTJLLEVBQWNDLEVBQWFDLEdBQ25DdkssS0FBS3dLLGFBQWU5SSxTQUFTQyxjQUFjMEksR0FDM0NySyxLQUFLeUssWUFBYy9JLFNBQVNDLGNBQWMySSxHQUMxQ3RLLEtBQUswSyxRQUFVaEosU0FBU0MsY0FBYzRJLEVBQ3hDLENBRUFJLFdBQUFBLEdBQ0UsTUFBTyxDQUNMekssS0FBTUYsS0FBS3dLLGFBQWF2SSxZQUN4QjZHLE1BQU85SSxLQUFLeUssWUFBWXhJLFlBRTVCLENBRUEySSxXQUFBQSxDQUFZQyxHQUNWN0ssS0FBS3dLLGFBQWF2SSxZQUFjNEksRUFBUzNLLEtBQ3pDRixLQUFLeUssWUFBWXhJLFlBQWM0SSxFQUFTL0IsS0FDMUMsQ0FFQWdDLFNBQUFBLENBQVNyRyxHQUFhLElBQVosT0FBRTJFLEdBQVEzRSxFQUNsQnpFLEtBQUswSyxRQUFRM0ksSUFBTXFILENBQ3JCLEdKc0J3QixrQkFBbUIsd0JBQXlCLG1CQUUxRSxJQUFJMkIsRUFFSm5ELEVBQUkyQixrQkFBa0JaLE1BQU1xQyxJQUMxQkQsRUFBVSxJQUFJN0UsRUFDWixDQUNFRSxNQUFPNEUsRUFDUDNFLFNBQVcxRyxJQUNULE1BQU1zTCxFQUFjLElBQUl4TCxFQUN0QkUsRUFDQSxpQkFDQUUsRUFDQW9CLEVBQ0FsQixHQUVGZ0wsRUFBUXBFLFNBQVNzRSxFQUFZeEosVUFBVSxHQUczQyxnQkFFRnNKLEVBQVF0RSxhQUFhLElBRXRCeUUsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQUVwQnZELEVBQUlZLGdCQUFnQkcsTUFBTWtDLElBQ3hCVCxFQUFTUSxZQUFZLENBQ25CMUssS0FBTTJLLEVBQVMzSyxLQUNmNEksTUFBTytCLEVBQVMvQixRQUVsQnNCLEVBQVNVLFVBQVUsQ0FBRTFCLE9BQVF5QixFQUFTekIsUUFBUyxJQUVoRDhCLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksSUFHaEIsTUFBTUcsRUFBZSxJQUFJakcsRUFDdkIsQ0FBRVgsY0FBZSxvQkFtRnZCLFNBQWlDbUIsR0FDL0J5RixFQUFhdEYsZUFBYyxHQUMzQjRCLEVBQ0d5QixRQUFRLENBQ1BuSixLQUFNMkYsRUFBWTNGLEtBQ2xCRSxLQUFNeUYsRUFBWXpGLE9BRW5CdUksTUFBTWhKLElBQ0wsTUFBTTRMLEVBM0VaLFNBQW9CNUwsR0FNbEIsT0FMYSxJQUFJRixFQUFLRSxFQUFNLGlCQUMxQkUsRUFDQW9CLEVBQ0FsQixHQUNBMEIsU0FFSixDQW9FbUIrSixDQUFXN0wsR0FDeEJvTCxFQUFRcEUsU0FBUzRFLEdBQ2pCRCxFQUFheEcsT0FBTyxJQUVyQm9HLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksSUFFbkJNLFNBQVEsS0FDUEgsRUFBYXRGLGVBQWMsRUFBTSxHQUV2QyxJQWpHVTBGLEVBQW1CLElBQUlyRyxFQUMzQixDQUFFWCxjQUFlLHdCQXFHdkIsU0FBcUNtQixHQUNuQzZGLEVBQWlCMUYsZUFBYyxHQUMvQjRCLEVBQ0dnQixhQUFhL0MsR0FDYjhDLE1BQU1nRCxJQUNMdkIsRUFBU1EsWUFBWWUsR0FDckJELEVBQWlCNUcsT0FBTyxJQUV6Qm9HLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksSUFFbkJNLFNBQVEsS0FDUEMsRUFBaUIxRixlQUFjLEVBQU0sR0FFM0MsSUEvR1U0RixFQUFrQixJQUFJdkcsRUFDMUIsQ0FBRVgsY0FBZSx1QkFldkIsU0FBNEJtQixHQUMxQitGLEVBQWdCNUYsZUFBYyxHQUM5QjRCLEVBQ0dzQixXQUFXLENBQUVFLE9BQVF2RCxFQUFZekYsT0FDakN1SSxNQUFNa0QsSUFDTHpCLEVBQVNVLFVBQVVlLEdBQ25CRCxFQUFnQjlHLE9BQU8sSUFFeEJvRyxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLElBRW5CTSxTQUFRLEtBQ1BHLEVBQWdCNUYsZUFBYyxFQUFNLEdBRTFDLElBRUEsU0FBUy9FLEVBQWFzSyxHQUNwQnZCLEVBQVlwRixPQUNab0YsRUFBWUcsaUJBQWdCLEtBQzFCSCxFQUFZaEUsZUFBYyxHQUMxQjRCLEVBQ0c0QixtQkFBbUIrQixFQUFLL0ssSUFDeEJtSSxNQUFLLEtBQ0o0QyxFQUFLdEssZUFDTCtJLEVBQVlsRixPQUFPLElBRXBCb0csT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQUVuQk0sU0FBUSxLQUNQekIsRUFBWWhFLGVBQWMsRUFBTSxHQUNoQyxHQUVSLENBRUEsU0FBU2pHLEVBQWV3TCxHQUNsQkEsRUFBSzdLLFNBQ1BrSCxFQUNHK0IsV0FBVzRCLEVBQUsvSyxJQUNoQm1JLE1BQUssS0FDSjRDLEVBQUtoSyxZQUFXLEVBQU0sSUFFdkIySixPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLElBR25CSSxFQUFLN0ssU0FDUmtILEVBQ0c4QixTQUFTNkIsRUFBSy9LLElBQ2RtSSxNQUFLLEtBQ0o0QyxFQUFLaEssWUFBVyxFQUFLLElBRXRCMkosT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxHQUcxQixDQXlDQSxTQUFTdEwsRUFBaUJpTSxHQUN4QjVFLEVBQWtCdEMsS0FBS2tILEVBQ3pCLENBSUFwRSxFQUFjNUcsaUJBQWlCLFNBQVMsS0FDdEN3SyxFQUFhMUcsT0FDYm1ILEVBQWlCdkksbUJBQW1CLElBR3RDc0QsRUFBZWhHLGlCQUFpQixTQUFTLEtBQ3ZDLE1BQU1rTCxFQUFlNUIsRUFBU08sY0FDOUJwRCxFQUFrQnhCLE1BQVFpRyxFQUFhOUwsS0FDdkN1SCxFQUF3QjFCLE1BQVFpRyxFQUFhbEQsTUFDN0M0QyxFQUFpQjlHLE9BQ2pCcUgsRUFBa0J6SSxtQkFBbUIsSUFHdkM0RCxFQUFhdEcsaUJBQWlCLFNBQVMsS0FDckM4SyxFQUFnQmhILE9BQ2hCc0gsRUFBb0IxSSxtQkFBbUIsSUFJekMsTUFBTXlJLEVBQW9CLElBQUkvSixFQUFjQyxFQUFVa0YsR0FDaEQwRSxFQUFtQixJQUFJN0osRUFBY0MsRUFBVW1GLEdBQy9DNEUsRUFBc0IsSUFBSWhLLEVBQWNDLEVBQVVnRixHQVN4RDhFLEVBQWtCL0gsbUJBQ2xCNkgsRUFBaUI3SCxtQkFDakJnSSxFQUFvQmhJLG1CQUVwQm9ILEVBQWFwRyxvQkFDYndHLEVBQWlCeEcsb0JBQ2pCZ0MsRUFBa0JoQyxvQkFDbEI4RSxFQUFZOUUsb0JBQ1owRyxFQUFnQjFHLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZURlbGV0ZUNhcmQsIGhhbmRsZUxpa2VDYXJkKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcbiAgICB0aGlzLmlkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkID0gaGFuZGxlTGlrZUNhcmQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCh0aGlzKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcylcbiAgICApO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMpXG4gICAgKTtcbiAgfVxuXG4gIGhhbmRsZURlbGV0ZSgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKXtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICAvLyBzZXQgaW5zdGFuY2UgdmFyaWFibGVcbiAgICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9pc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLmlzTGlrZWQ7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAvL2dldCB0aGUgY2FyZCB2aWV3XG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fdGl0bGVcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWUgKyBcIiBcIiArIFwiSW1hZ2VcIjtcbiAgICB0aGlzLl9jYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICB0aGlzLl9yZW5kZXJMaWtlcygpXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIC8vcmV0dXJuIHRoZSBjYXJkXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcblxuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiIFwiO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiAhaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpe1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpXG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgfVxuXG4gICAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICAgIH1cblxuICAgICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgfVxuXG4gICAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9LCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIH1cblxuICAgIG9wZW4oKSB7XG4gICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICBzdXBlci5jbG9zZSgpO1xuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICAgIH1cbiAgICBcbiAgICAgIHJlbmRlckl0ZW1zKCkge1xuICAgICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIFxuICAgICAgYWRkSXRlbXMoZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9IiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWJ1dHRvblwiKVxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbENsb3NlID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLW1vZGFsLWNsb3NlXCJcbik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2UgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjYWRkLWNhcmQtbW9kYWwtY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxDbG9zZSA9IHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3ByZXZpZXctbW9kYWwtY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld05hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcbik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcblxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCJcbik7XG5leHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91cmxcIik7XG5cbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZVwiKTtcblxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59OyIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCAnLi4vcGFnZXMvaW5kZXguY3NzJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanNcIlxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIGNhcmRMaXN0RWwsXG4gIHByb2ZpbGVFZGl0QnRuLFxuICBwcm9maWxlRWRpdEZvcm0sXG4gIGFkZENhcmRGb3JtLFxuICBhZGRDYXJkTW9kYWwsXG4gIGF2YXRhckJ1dHRvbixcbiAgYWRkQ2FyZEJ1dHRvbixcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIGF2YXRhckZvcm0sXG4gIHNldHRpbmdzLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG4vL2NvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgJyNjYXJkLXRlbXBsYXRlJyk7XG4vL2NhcmQuX2dldFZpZXcoKTtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNDE1OTdkZjItZWI5My00YjQxLThiZjEtZjRhNTQyYTllYTU0XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgfVxufSk7XG5cbi8vQ2xhc3MgSW5zdGFuY2VzXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7IHBvcHVwU2VsZWN0b3I6IFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIiB9KTtcbmNvbnN0IHBvcHVwRGVsZXRlID0gbmV3IFBvcHVwV2l0aERlbGV0ZSh7IHBvcHVwU2VsZWN0b3I6IFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIgfSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX3RpdGxlXCIsIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsIFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xuXG5sZXQgc2VjdGlvbjtcblxuYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKGluaXRpYWxDYXJkcykgPT4ge1xuICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAge1xuICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxuICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgICAgICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgICAgICAgaGFuZGxlRGVsZXRlLFxuICAgICAgICAgIGhhbmRsZUxpa2VDYXJkXG4gICAgICAgICk7XG4gICAgICAgIHNlY3Rpb24uYWRkSXRlbXMoY2FyZEVsZW1lbnQuZ2V0VmlldygpKTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICBcIi5jYXJkc19fbGlzdFwiXG4gICk7XG4gIHNlY3Rpb24ucmVuZGVySXRlbXMoKTtcbn0pXG4uY2F0Y2goKGVycikgPT4ge1xuICBjb25zb2xlLmVycm9yKGVycik7XG59KTtcbmFwaS5mZXRjaFVzZXJJbmZvKCkudGhlbigodXNlckRhdGEpID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxuICB9KTtcbiAgdXNlckluZm8uc2V0QXZhdGFyKHsgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIgfSk7XG59KVxuLmNhdGNoKChlcnIpID0+IHtcbiAgY29uc29sZS5lcnJvcihlcnIpO1xufSk7XG5cbiAgICBjb25zdCBhZGRDYXJkUG9wVXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgICAgIHsgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIiB9LFxuICAgICAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcbiAgICApO1xuXG4gICAgY29uc3QgZWRpdFByb2ZpbGVQb3BVcCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgICAgeyBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIiB9LFxuICAgICAgaGFuZGxlUHJvZmlsZUVkaXRGb3JtU3VibWl0XG4gICAgKTtcblxuICAgIGNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgICAgeyBwb3B1cFNlbGVjdG9yOiBcIiNhdmF0YXItZWRpdC1tb2RhbFwiIH0sXG4gICAgICBoYW5kbGVBdmF0YXJTdWJtaXRcbiAgICApO1xuXG4vKkZ1bmN0aW9ucyovXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlLFxuICAgIGhhbmRsZUxpa2VDYXJkXG4gICkuZ2V0VmlldygpO1xuICByZXR1cm4gY2FyZDtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuZWRpdEF2YXRhcih7IGF2YXRhcjogaW5wdXRWYWx1ZXMubGluayB9KVxuICAgIC50aGVuKChuZXdBdmF0YXIpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhcihuZXdBdmF0YXIpO1xuICAgICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGUoY2FyZCkge1xuICBwb3B1cERlbGV0ZS5vcGVuKCk7XG4gIHBvcHVwRGVsZXRlLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgcG9wdXBEZWxldGUucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVJbml0aWFsQ2FyZHMoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGUoKTtcbiAgICAgICAgcG9wdXBEZWxldGUuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwb3B1cERlbGV0ZS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQoY2FyZCkge1xuICBpZiAoY2FyZC5pc0xpa2VkKSB7XG4gICAgYXBpXG4gICAgICAudW5saWtlQ2FyZChjYXJkLmlkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLnNldElzTGlrZWQoZmFsc2UpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG4gIGlmICghY2FyZC5pc0xpa2VkKSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5zZXRJc0xpa2VkKHRydWUpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGFkZENhcmRQb3BVcC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuYWRkQ2FyZCh7XG4gICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgICAgbGluazogaW5wdXRWYWx1ZXMubGluayxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcbiAgICAgIHNlY3Rpb24uYWRkSXRlbXMoY2FyZCk7XG4gICAgICBhZGRDYXJkUG9wVXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhZGRDYXJkUG9wVXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cblxuXG4vL0V2ZW50IEhhbmRsZXJzXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgZWRpdFByb2ZpbGVQb3BVcC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChuZXdVc2VyRGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8obmV3VXNlckRhdGEpO1xuICAgICAgZWRpdFByb2ZpbGVQb3BVcC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlUG9wVXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcbiAgcHJldmlld0ltYWdlTW9kYWwub3BlbihjYXJkRGF0YSk7XG59XG5cbi8qRXZlbnQgTGlzdGVuZXJzKi9cbi8vYWRkIG5ldyBDYXJkIGJ1dHRvblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkUG9wVXAub3BlbigpO1xuICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG59KTtcblxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgdXNlckluZm9EYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VySW5mb0RhdGEubmFtZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VySW5mb0RhdGEuYWJvdXQ7XG4gIGVkaXRQcm9maWxlUG9wVXAub3BlbigpO1xuICBlZGl0Rm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG5cbmF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0QXZhdGFyUG9wdXAub3BlbigpO1xuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG59KTtcblxuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwcm9maWxlRWRpdEZvcm0pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhZGRDYXJkRm9ybSk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGF2YXRhckZvcm0pO1xuXG4vL2Z1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcbiAgLy9jb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIC8vc2VjdGlvbi5hZGRJdGVtcyhjYXJkKTtcbi8vfVxuXG4vL1ZhbGlkYXRpb25cblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuYWRkQ2FyZFBvcFVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0UHJvZmlsZVBvcFVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5wcmV2aWV3SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBEZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaXtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG5fY2hlY2tSZXNwb25zZShyZXMpe1xuICBpZiAocmVzLm9rKSB7XG4gICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gIH1cbiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xufVxuXG4gIGZldGNoVXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdEF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUluaXRpYWxDYXJkcyhjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbiAgICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1kZXNjcmlwdGlvblwiKTtcbiAgICB9XG5cbiAgICBvcGVuKGRhdGEpIHtcbiAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCBkYXRhLl9saW5rKTtcbiAgICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBkYXRhLl9uYW1lKTtcbiAgICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLl9uYW1lO1xuICAgIH1cbiAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cHdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2RlbGV0ZVBvcHVwID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2NvbmZpcm1cIik7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2RlbGV0ZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZSgpO1xuICAgICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihoYW5kbGVEZWxldGUpIHtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfVxuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIHVzZXJBdmF0YXIpIHtcbiAgICAgICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyKTtcbiAgICAgIH1cblxuICAgICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgICAgYWJvdXQ6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHNldFVzZXJJbmZvKHVzZXJEYXRhKSB7XG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xuICAgICAgfVxuXG4gICAgICBzZXRBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgICAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xuICAgICAgfVxuICAgIH0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUNhcmQiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJpZCIsIl9pZCIsImlzTGlrZWQiLCJfaGFuZGxlTGlrZUNhcmQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiaGFuZGxlRGVsZXRlIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiX3JlbmRlckxpa2VzIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0SXNMaWtlZCIsIl9pc0xpa2VkIiwiZ2V0VmlldyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlRWwiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZGlzYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImlucHV0TGlzdCIsImV2ZXJ5IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIlBvcHVwIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dEVsZW1lbnRzIiwiX2J1dHRvbkVsZW1lbnQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtcyIsImVsZW1lbnQiLCJwcmVwZW5kIiwicHJvZmlsZUVkaXRCdG4iLCJwcm9maWxlRWRpdE1vZGFsIiwiYXZhdGFyTW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJCdXR0b24iLCJwcm9maWxlRWRpdEZvcm0iLCJhZGRDYXJkRm9ybSIsInByb2ZpbGVUaXRsZUlucHV0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImFkZENhcmRCdXR0b24iLCJmb3JtU2VsZWN0b3IiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaFVzZXJJbmZvIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJhYm91dCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhciIsIl9yZWYzIiwiYXZhdGFyIiwiYWRkQ2FyZCIsIl9yZWY0IiwiZ2V0SW5pdGlhbENhcmRzIiwiZGVsZXRlSW5pdGlhbENhcmRzIiwiY2FyZElEIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsIl9pbWFnZSIsIl9jYXB0aW9uIiwic2V0QXR0cmlidXRlIiwicG9wdXBEZWxldGUiLCJfZGVsZXRlUG9wdXAiLCJfaGFuZGxlRGVsZXRlIiwic2V0U3VibWl0QWN0aW9uIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsInVzZXJBdmF0YXIiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwidXNlckRhdGEiLCJzZXRBdmF0YXIiLCJzZWN0aW9uIiwiaW5pdGlhbENhcmRzIiwiY2FyZEVsZW1lbnQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImFkZENhcmRQb3BVcCIsImNhcmQiLCJjcmVhdGVDYXJkIiwiZmluYWxseSIsImVkaXRQcm9maWxlUG9wVXAiLCJuZXdVc2VyRGF0YSIsImVkaXRBdmF0YXJQb3B1cCIsIm5ld0F2YXRhciIsImNhcmREYXRhIiwiYWRkRm9ybVZhbGlkYXRvciIsInVzZXJJbmZvRGF0YSIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=