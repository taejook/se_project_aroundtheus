!function(){"use strict";class e{constructor(e,t,r,s,i){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteCard=s,this.id=e._id,this.isLiked=e.isLiked,this._handleLikeCard=i}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)})),this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this))),this._cardImageEl.addEventListener("click",(()=>this._handleImageClick(this)))}handleDelete(){this._cardElement.remove(),this._cardElement=null}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}_renderLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".cards__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name+" Image",this._cardTitleEl.textContent=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._renderLikes(),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this.errorMessageElement.textContent=e.validationMessage,this.errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this.errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this.errorMessageElement.textContent=" ",this.errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._form.reset(),this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close")&&this.close()}))}}class s extends r{constructor(e,t){let{popupSelector:r}=e;super({popupSelector:r}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputElements=this._popupForm.querySelectorAll(".modal__input"),this._buttonElement=this._popupForm.querySelector(".modal__button")}open(){super.open()}close(){super.close(),this._popupForm.reset()}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}class i{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItems(e){this._container.prepend(e)}}document.querySelectorAll(".modal__form");const n=document.querySelector("#profile-edit-button"),o=document.querySelector("#profile-edit-modal"),a=document.querySelector("#avatar-edit-modal"),l=document.querySelector("#add-card-modal"),d=document.querySelector("#preview-image-modal"),c=a.querySelector(".modal__form"),u=document.querySelector(".profile__image-button"),h=(o.querySelector("#profile-modal-close"),l.querySelector("#add-card-modal-close"),d.querySelector("#preview-modal-close"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-name"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-edit-form")),_=l.querySelector("#add-card-form"),m=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".profile__add-button"),document.querySelector("#profile-title-input")),p=document.querySelector("#profile-description-input"),E=(_.querySelector(".modal__input_type_title"),_.querySelector(".modal__input_type_url"),document.querySelectorAll(".modal__close"),document.querySelector(".profile__add-button")),S={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},v=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}fetchUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}deleteInitialCards(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"PUT"}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"41597df2-eb93-4b41-8bf1-f4a542a9ea54","Content-Type":"application/json"}}),f=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._image=this._popupElement.querySelector(".modal__preview-image"),this._caption=this._popupElement.querySelector(".modal__preview-description")}open(e){super.open(),this._image.setAttribute("src",e._link),this._image.setAttribute("alt",e._name),this._caption.textContent=e._name}}({popupSelector:"#preview-image-modal"}),y=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._deletePopup=this._popupElement.querySelector("#modal__confirm"),this._buttonElement=this._deletePopup.querySelector(".modal__button")}setEventListeners(){this._popupElement.querySelector(".modal__button").addEventListener("click",(()=>{this._handleDelete()})),super.setEventListeners()}setSubmitAction(e){this._handleDelete=e}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}}({popupSelector:"#delete-card-modal"}),b=new class{constructor(e,t,r){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,description:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.about}setAvatar(e){let{avatar:t}=e;this._avatar.src=t}}(".profile__title",".profile__description",".profile__image");let L;v.getInitialCards().then((t=>{L=new i({items:t,renderer:t=>{const r=new e(t,"#card-template",B,C,I);L.addItems(r.getView())}},".cards__list"),L.renderItems()})).catch((e=>{console.error(e)})),v.fetchUserInfo().then((e=>{b.setUserInfo({name:e.name,about:e.about}),b.setAvatar({avatar:e.avatar})})).catch((e=>{console.error(e)}));const k=new s({popupSelector:"#add-card-modal"},(function(t){k.renderLoading(!0),v.addCard({name:t.name,link:t.link}).then((t=>{const r=function(t){return new e(t,"#card-template",B,C,I).getView()}(t);L.addItems(r),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.renderLoading(!1)}))})),g=new s({popupSelector:"#profile-edit-modal"},(function(e){g.renderLoading(!0),v.editUserInfo(e).then((e=>{b.setUserInfo(e),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.renderLoading(!1)}))})),q=new s({popupSelector:"#avatar-edit-modal"},(function(e){q.renderLoading(!0),v.editAvatar({avatar:e.link}).then((e=>{b.setAvatar(e),q.close()})).catch((e=>{console.error(e)})).finally((()=>{q.renderLoading(!1)}))}));function C(e){y.open(),y.setSubmitAction((()=>{y.renderLoading(!0),v.deleteInitialCards(e.id).then((()=>{e.handleDelete(),y.close()})).catch((e=>{console.error(e)})).finally((()=>{y.renderLoading(!1)}))}))}function I(e){e.isLiked&&v.unlikeCard(e.id).then((()=>{e.setIsLiked()})).catch((e=>{console.error(e)})),e.isLiked||v.likeCard(e.id).then((()=>{e.setIsLiked()})).catch((e=>{console.error(e)}))}function B(e){f.open(e)}E.addEventListener("click",(()=>{k.open(),U.toggleButtonState()})),n.addEventListener("click",(()=>{const e=b.getUserInfo();m.value=e.name,p.value=e.about,g.open(),w.toggleButtonState()})),u.addEventListener("click",(()=>{q.open(),A.toggleButtonState()}));const w=new t(S,h),U=new t(S,_),A=new t(S,c);w.enableValidation(),U.enableValidation(),A.enableValidation(),k.setEventListeners(),g.setEventListeners(),f.setEventListeners(),y.setEventListeners(),q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q05DLFFBQVFDLE1BQU1GLEVBQUksR0FHMUIsQ0F5Q0EsU0FBU3ZMLEVBQWlCa00sR0FDeEI3RSxFQUFrQnRDLEtBQUttSCxFQUN6QixDQUlBckUsRUFBYzVHLGlCQUFpQixTQUFTLEtBQ3RDeUssRUFBYTNHLE9BQ2JvSCxFQUFpQnhJLG1CQUFtQixJQUd0Q3NELEVBQWVoRyxpQkFBaUIsU0FBUyxLQUN2QyxNQUFNbUwsRUFBZTdCLEVBQVNPLGNBQzlCcEQsRUFBa0J4QixNQUFRa0csRUFBYS9MLEtBQ3ZDdUgsRUFBd0IxQixNQUFRa0csRUFBYW5ELE1BQzdDNkMsRUFBaUIvRyxPQUNqQnNILEVBQWtCMUksbUJBQW1CLElBR3ZDNEQsRUFBYXRHLGlCQUFpQixTQUFTLEtBQ3JDK0ssRUFBZ0JqSCxPQUNoQnVILEVBQW9CM0ksbUJBQW1CLElBSXpDLE1BQU0wSSxFQUFvQixJQUFJaEssRUFBY0MsRUFBVWtGLEdBQ2hEMkUsRUFBbUIsSUFBSTlKLEVBQWNDLEVBQVVtRixHQUMvQzZFLEVBQXNCLElBQUlqSyxFQUFjQyxFQUFVZ0YsR0FTeEQrRSxFQUFrQmhJLG1CQUNsQjhILEVBQWlCOUgsbUJBQ2pCaUksRUFBb0JqSSxtQkFFcEJxSCxFQUFhckcsb0JBQ2J5RyxFQUFpQnpHLG9CQUNqQmdDLEVBQWtCaEMsb0JBQ2xCOEUsRUFBWTlFLG9CQUNaMkcsRUFBZ0IzRyxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0ZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGVDYXJkLCBoYW5kbGVMaWtlQ2FyZCkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XG4gICAgdGhpcy5pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuaXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblxuICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQodGhpcyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMpXG4gICAgKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzKVxuICAgICk7XG4gIH1cblxuICBoYW5kbGVEZWxldGUoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgc2V0SXNMaWtlZChpc0xpa2VkKSB7XG4gICAgLy8gc2V0IGluc3RhbmNlIHZhcmlhYmxlXG4gICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpe1xuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIC8vZ2V0IHRoZSBjYXJkIHZpZXdcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX190aXRsZVwiKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gdGhpcy5fbmFtZSArIFwiIFwiICsgXCJJbWFnZVwiO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcbiAgICAgICAgLy9zZXQgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIHRoaXMuX3JlbmRlckxpa2VzKClcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgLy9yZXR1cm4gdGhlIGNhcmRcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuXG4gIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWw7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCIgXCI7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG5cbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgcmV0dXJuICFpbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCl7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbClcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICB9XG5cbiAgICAgIG9wZW4oKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgfVxuXG4gICAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgICB9XG5cbiAgICAgIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XG4gICAgICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0sIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICB9XG5cbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcbiAgICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgICAgfVxuICAgIFxuICAgICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgXG4gICAgICBhZGRJdGVtcyhlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICAgICAgfVxuICAgIH0iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm1cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2UtYnV0dG9uXCIpXG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2UgPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtbW9kYWwtY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWxDbG9zZSA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNhZGQtY2FyZC1tb2RhbC1jbG9zZVwiXG4pO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdNb2RhbENsb3NlID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJldmlldy1tb2RhbC1jbG9zZVwiXG4pO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxuKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWZvcm1cIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGNhcmRMaXN0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xuXG5leHBvcnQgY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuZXhwb3J0IGNvbnN0IGNhcmRUaXRsZUlucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfdGl0bGVcIlxuKTtcbmV4cG9ydCBjb25zdCBjYXJkVXJsSW5wdXQgPSBhZGRDYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3VybFwiKTtcblxuZXhwb3J0IGNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlXCIpO1xuXG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07IiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRGVsZXRlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0ZS5qc1wiXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgY2FyZExpc3RFbCxcbiAgcHJvZmlsZUVkaXRCdG4sXG4gIHByb2ZpbGVFZGl0Rm9ybSxcbiAgYWRkQ2FyZEZvcm0sXG4gIGFkZENhcmRNb2RhbCxcbiAgYXZhdGFyQnV0dG9uLFxuICBhZGRDYXJkQnV0dG9uLFxuICBhZGROZXdDYXJkQnV0dG9uLFxuICBwcm9maWxlVGl0bGVJbnB1dCxcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIGF2YXRhckZvcm0sXG4gIHNldHRpbmdzLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG4vL2NvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgJyNjYXJkLXRlbXBsYXRlJyk7XG4vL2NhcmQuX2dldFZpZXcoKTtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNDE1OTdkZjItZWI5My00YjQxLThiZjEtZjRhNTQyYTllYTU0XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgfVxufSk7XG5cbi8vQ2xhc3MgSW5zdGFuY2VzXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7IHBvcHVwU2VsZWN0b3I6IFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIiB9KTtcbmNvbnN0IHBvcHVwRGVsZXRlID0gbmV3IFBvcHVwV2l0aERlbGV0ZSh7IHBvcHVwU2VsZWN0b3I6IFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIgfSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX3RpdGxlXCIsIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsIFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xuXG5sZXQgc2VjdGlvbjtcblxuYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKGluaXRpYWxDYXJkcykgPT4ge1xuICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAge1xuICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxuICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgICAgICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgICAgICAgaGFuZGxlRGVsZXRlLFxuICAgICAgICAgIGhhbmRsZUxpa2VDYXJkXG4gICAgICAgICk7XG4gICAgICAgIHNlY3Rpb24uYWRkSXRlbXMoY2FyZEVsZW1lbnQuZ2V0VmlldygpKTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICBcIi5jYXJkc19fbGlzdFwiXG4gICk7XG4gIHNlY3Rpb24ucmVuZGVySXRlbXMoKTtcbn0pXG4uY2F0Y2goKGVycikgPT4ge1xuICBjb25zb2xlLmVycm9yKGVycik7XG59KTtcbmFwaS5mZXRjaFVzZXJJbmZvKCkudGhlbigodXNlckRhdGEpID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxuICB9KTtcbiAgdXNlckluZm8uc2V0QXZhdGFyKHsgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIgfSk7XG59KVxuLmNhdGNoKChlcnIpID0+IHtcbiAgY29uc29sZS5lcnJvcihlcnIpO1xufSk7XG5cbiAgICBjb25zdCBhZGRDYXJkUG9wVXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgICAgIHsgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIiB9LFxuICAgICAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcbiAgICApO1xuXG4gICAgY29uc3QgZWRpdFByb2ZpbGVQb3BVcCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgICAgeyBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIiB9LFxuICAgICAgaGFuZGxlUHJvZmlsZUVkaXRGb3JtU3VibWl0XG4gICAgKTtcblxuICAgIGNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgICAgeyBwb3B1cFNlbGVjdG9yOiBcIiNhdmF0YXItZWRpdC1tb2RhbFwiIH0sXG4gICAgICBoYW5kbGVBdmF0YXJTdWJtaXRcbiAgICApO1xuXG4vKkZ1bmN0aW9ucyovXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlLFxuICAgIGhhbmRsZUxpa2VDYXJkXG4gICkuZ2V0VmlldygpO1xuICByZXR1cm4gY2FyZDtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuZWRpdEF2YXRhcih7IGF2YXRhcjogaW5wdXRWYWx1ZXMubGluayB9KVxuICAgIC50aGVuKChuZXdBdmF0YXIpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhcihuZXdBdmF0YXIpO1xuICAgICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGUoY2FyZCkge1xuICBwb3B1cERlbGV0ZS5vcGVuKCk7XG4gIHBvcHVwRGVsZXRlLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgcG9wdXBEZWxldGUucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVJbml0aWFsQ2FyZHMoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGUoKTtcbiAgICAgICAgcG9wdXBEZWxldGUuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwb3B1cERlbGV0ZS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQoY2FyZCkge1xuICBpZiAoY2FyZC5pc0xpa2VkKSB7XG4gICAgYXBpXG4gICAgICAudW5saWtlQ2FyZChjYXJkLmlkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLnNldElzTGlrZWQoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuICBpZiAoIWNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuc2V0SXNMaWtlZCgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGFkZENhcmRQb3BVcC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuYWRkQ2FyZCh7XG4gICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgICAgbGluazogaW5wdXRWYWx1ZXMubGluayxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcbiAgICAgIHNlY3Rpb24uYWRkSXRlbXMoY2FyZCk7XG4gICAgICBhZGRDYXJkUG9wVXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhZGRDYXJkUG9wVXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cblxuXG4vL0V2ZW50IEhhbmRsZXJzXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgZWRpdFByb2ZpbGVQb3BVcC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChuZXdVc2VyRGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8obmV3VXNlckRhdGEpO1xuICAgICAgZWRpdFByb2ZpbGVQb3BVcC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlUG9wVXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcbiAgcHJldmlld0ltYWdlTW9kYWwub3BlbihjYXJkRGF0YSk7XG59XG5cbi8qRXZlbnQgTGlzdGVuZXJzKi9cbi8vYWRkIG5ldyBDYXJkIGJ1dHRvblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkUG9wVXAub3BlbigpO1xuICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG59KTtcblxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgdXNlckluZm9EYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VySW5mb0RhdGEubmFtZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VySW5mb0RhdGEuYWJvdXQ7XG4gIGVkaXRQcm9maWxlUG9wVXAub3BlbigpO1xuICBlZGl0Rm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG5cbmF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0QXZhdGFyUG9wdXAub3BlbigpO1xuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG59KTtcblxuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwcm9maWxlRWRpdEZvcm0pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhZGRDYXJkRm9ybSk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGF2YXRhckZvcm0pO1xuXG4vL2Z1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcbiAgLy9jb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIC8vc2VjdGlvbi5hZGRJdGVtcyhjYXJkKTtcbi8vfVxuXG4vL1ZhbGlkYXRpb25cblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuYWRkQ2FyZFBvcFVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0UHJvZmlsZVBvcFVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5wcmV2aWV3SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBEZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaXtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG5fY2hlY2tSZXNwb25zZShyZXMpe1xuICBpZiAocmVzLm9rKSB7XG4gICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gIH1cbiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xufVxuXG4gIGZldGNoVXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdEF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUluaXRpYWxDYXJkcyhjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbiAgICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1kZXNjcmlwdGlvblwiKTtcbiAgICB9XG5cbiAgICBvcGVuKGRhdGEpIHtcbiAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCBkYXRhLl9saW5rKTtcbiAgICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBkYXRhLl9uYW1lKTtcbiAgICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLl9uYW1lO1xuICAgIH1cbiAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cHdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2RlbGV0ZVBvcHVwID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2NvbmZpcm1cIik7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2RlbGV0ZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZSgpO1xuICAgICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihoYW5kbGVEZWxldGUpIHtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfVxuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIHVzZXJBdmF0YXIpIHtcbiAgICAgICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyKTtcbiAgICAgIH1cblxuICAgICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHNldFVzZXJJbmZvKHVzZXJEYXRhKSB7XG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xuICAgICAgfVxuXG4gICAgICBzZXRBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgICAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xuICAgICAgfVxuICAgIH0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUNhcmQiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJpZCIsIl9pZCIsImlzTGlrZWQiLCJfaGFuZGxlTGlrZUNhcmQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiaGFuZGxlRGVsZXRlIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwic2V0SXNMaWtlZCIsIl9pc0xpa2VkIiwiX3JlbmRlckxpa2VzIiwiY2xhc3NMaXN0IiwiYWRkIiwiZ2V0VmlldyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlRWwiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZGlzYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImlucHV0TGlzdCIsImV2ZXJ5IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIlBvcHVwIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dEVsZW1lbnRzIiwiX2J1dHRvbkVsZW1lbnQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtcyIsImVsZW1lbnQiLCJwcmVwZW5kIiwicHJvZmlsZUVkaXRCdG4iLCJwcm9maWxlRWRpdE1vZGFsIiwiYXZhdGFyTW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJCdXR0b24iLCJwcm9maWxlRWRpdEZvcm0iLCJhZGRDYXJkRm9ybSIsInByb2ZpbGVUaXRsZUlucHV0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImFkZENhcmRCdXR0b24iLCJmb3JtU2VsZWN0b3IiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaFVzZXJJbmZvIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJhYm91dCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhciIsIl9yZWYzIiwiYXZhdGFyIiwiYWRkQ2FyZCIsIl9yZWY0IiwiZ2V0SW5pdGlhbENhcmRzIiwiZGVsZXRlSW5pdGlhbENhcmRzIiwiY2FyZElEIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsIl9pbWFnZSIsIl9jYXB0aW9uIiwic2V0QXR0cmlidXRlIiwicG9wdXBEZWxldGUiLCJfZGVsZXRlUG9wdXAiLCJfaGFuZGxlRGVsZXRlIiwic2V0U3VibWl0QWN0aW9uIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsInVzZXJBdmF0YXIiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJ1c2VyRGF0YSIsInNldEF2YXRhciIsInNlY3Rpb24iLCJpbml0aWFsQ2FyZHMiLCJjYXJkRWxlbWVudCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYWRkQ2FyZFBvcFVwIiwiY2FyZCIsImNyZWF0ZUNhcmQiLCJmaW5hbGx5IiwiZWRpdFByb2ZpbGVQb3BVcCIsIm5ld1VzZXJEYXRhIiwiZWRpdEF2YXRhclBvcHVwIiwibmV3QXZhdGFyIiwiY2FyZERhdGEiLCJhZGRGb3JtVmFsaWRhdG9yIiwidXNlckluZm9EYXRhIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==